(()=>{"use strict";var e,t={295:(e,t,s)=>{var a=s(440),i=s.n(a);class r extends i().Scene{constructor(){super("MenuScene")}create(){this.add.text(this.scale.width/2,150,"Karate Kido",{font:"64px Arial",color:"#fff",fontStyle:"bold"}).setOrigin(.5);const e={font:"32px Arial",color:"#222",backgroundColor:"#fff",padding:{x:20,y:10}};this.add.text(this.scale.width/2,300,"Start Game",e).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",()=>this.scene.start("GameScene")),this.add.text(this.scale.width/2,380,"Options",e).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",()=>this.showOptions()),this.add.text(this.scale.width/2,460,"Credits",e).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",()=>this.showCredits())}showOptions(){alert("Options coming soon!")}showCredits(){alert("Created by instakarate!")}}class h extends i().Physics.Arcade.Sprite{constructor(e,t,s){super(e,t,s,"player_idle"),e.add.existing(this),e.physics.add.existing(this),this.health=100,this.maxHealth=100,this.stamina=100,this.maxStamina=100,this.score=0,this.isMoving=!1,this.isAttacking=!1,this.isBlocking=!1,this.isDead=!1,this.body.setCollideWorldBounds(!0),this.setupAnimations(e),e.inputHandler.on("move",e=>this.handleMove(e)),e.inputHandler.on("attack",e=>this.handleAttack(e)),e.inputHandler.on("block",()=>this.handleBlock()),this.currentAnim="idle"}setupAnimations(e){e.anims.create({key:"idle",frames:e.anims.generateFrameNumbers("player_idle",{start:0,end:3}),frameRate:6,repeat:-1}),e.anims.create({key:"walk",frames:e.anims.generateFrameNumbers("player_walk",{start:0,end:5}),frameRate:10,repeat:-1}),e.anims.create({key:"punch",frames:e.anims.generateFrameNumbers("player_punch",{start:0,end:2}),frameRate:12,repeat:0}),e.anims.create({key:"kick",frames:e.anims.generateFrameNumbers("player_kick",{start:0,end:2}),frameRate:12,repeat:0}),e.anims.create({key:"block",frames:e.anims.generateFrameNumbers("player_block",{start:0,end:1}),frameRate:8,repeat:-1}),e.anims.create({key:"hurt",frames:e.anims.generateFrameNumbers("player_hurt",{start:0,end:1}),frameRate:8,repeat:0})}update(){this.isDead||this.isAttacking||(this.isBlocking?this.play("block",!0):0!==this.body.velocity.x?(this.play("walk",!0),this.isMoving=!0):(this.play("idle",!0),this.isMoving=!1))}handleMove(e){if(this.isDead||this.isAttacking)return;switch(e){case"left":this.setVelocityX(-220),this.setFlipX(!0);break;case"right":this.setVelocityX(220),this.setFlipX(!1);break;case"up":this.setVelocityY(-220);break;case"down":this.setVelocityY(220);break;default:this.setVelocity(0)}}handleAttack(e){if(this.isDead||this.isAttacking||this.isBlocking)return;this.isAttacking=!0,this.setVelocity(0);let t="kick"===e?"kick":"punch";this.play(t,!0),this.once("animationcomplete",()=>{this.isAttacking=!1,this.emit("attackComplete",e)})}handleBlock(){this.isDead||(this.isBlocking=!0,this.play("block",!0),this.scene.time.delayedCall(800,()=>{this.isBlocking=!1}))}takeDamage(e){this.isBlocking&&(e=Math.max(3,.35*e)),this.health=Math.max(0,this.health-e),this.play("hurt",!0),this.health<=0&&this.die()}die(){this.isDead=!0,this.setVelocity(0),this.play("hurt",!0)}recoverStamina(e){this.stamina=Math.min(this.maxStamina,this.stamina+e)}useStamina(e){this.stamina=Math.max(0,this.stamina-e)}}const o={easy:{health:60,damage:7,speed:120,attackFreq:1800},medium:{health:90,damage:12,speed:180,attackFreq:1200},hard:{health:120,damage:18,speed:220,attackFreq:800},boss:{health:200,damage:25,speed:280,attackFreq:500}};class n extends i().Physics.Arcade.Sprite{constructor(e,t,s,a="easy"){super(e,t,s,"enemy_idle"),e.add.existing(this),e.physics.add.existing(this),this.difficulty=a,Object.assign(this,o[a]),this.maxHealth=this.health,this.isDead=!1,this.state="patrol",this.body.setCollideWorldBounds(!0),this.setupAnimations(e),this.decisionTimer=e.time.addEvent({delay:this.attackFreq,loop:!0,callback:this.aiDecision,callbackScope:this}),this.target=e.player}setupAnimations(e){e.anims.create({key:"enemy_idle",frames:e.anims.generateFrameNumbers("enemy_idle",{start:0,end:3}),frameRate:6,repeat:-1}),e.anims.create({key:"enemy_walk",frames:e.anims.generateFrameNumbers("enemy_walk",{start:0,end:5}),frameRate:10,repeat:-1}),e.anims.create({key:"enemy_punch",frames:e.anims.generateFrameNumbers("enemy_punch",{start:0,end:2}),frameRate:12,repeat:0}),e.anims.create({key:"enemy_kick",frames:e.anims.generateFrameNumbers("enemy_kick",{start:0,end:2}),frameRate:12,repeat:0}),e.anims.create({key:"enemy_block",frames:e.anims.generateFrameNumbers("enemy_block",{start:0,end:1}),frameRate:8,repeat:-1}),e.anims.create({key:"enemy_hurt",frames:e.anims.generateFrameNumbers("enemy_hurt",{start:0,end:1}),frameRate:8,repeat:0})}update(){this.isDead||("patrol"===this.state?this.patrol():"pursue"===this.state?this.pursue():"attack"===this.state?this.attack():"evade"===this.state?this.evade():"defend"===this.state&&this.block())}aiDecision(){if(this.isDead)return;const e=i().Math.Distance.Between(this.x,this.y,this.target.x,this.target.y);e<80?Math.random()<.7?this.state="attack":this.state="defend":this.state=e<300?"pursue":Math.random()<.4?"evade":"patrol"}patrol(){this.setVelocityX(this.speed*(Math.random()>.5?1:-1)),this.play("enemy_walk",!0)}pursue(){const e=this.target.x<this.x?-1:1;this.setVelocityX(this.speed*e),this.play("enemy_walk",!0)}attack(){this.setVelocity(0);const e=Math.random()>.5?"enemy_punch":"enemy_kick";this.play(e,!0),this.once("animationcomplete",()=>{this.emit("attackComplete",e.includes("kick")?"kick":"punch"),this.state="patrol"})}block(){this.setVelocity(0),this.play("enemy_block",!0),this.scene.time.delayedCall(600,()=>{this.state="patrol"})}evade(){this.setVelocityX(this.speed*(Math.random()>.5?1:-1)),this.play("enemy_walk",!0),this.scene.time.delayedCall(350,()=>{this.state="patrol"})}takeDamage(e){this.health=Math.max(0,this.health-e),this.play("enemy_hurt",!0),this.health<=0&&this.die()}die(){this.isDead=!0,this.setVelocity(0),this.play("enemy_hurt",!0),this.decisionTimer.remove()}}var l=s(7),c=s.n(l);class m extends(c()){constructor(e,t,s){super(),this.scene=e,this.player=t,this.enemy=s,this.comboCount=0,this.comboMultiplier=1,this.comboTimer=null,this.comboBreakDuration=4e3,this.player.on("attackComplete",e=>this.handleAttack(this.player,this.enemy,e)),this.enemy.on("attackComplete",e=>this.handleAttack(this.enemy,this.player,e))}update(){}handleAttack(e,t,s){if(!e.isDead&&!t.isDead)if(i().Math.Distance.Between(e.x,e.y,t.x,t.y)<70){let a=("kick"===s?15:10)*this.comboMultiplier;t.isBlocking?(a=Math.max(3,.35*a),this.emit("block",{attacker:e,defender:t,reduced:a})):this.emit("hit",{attacker:e,defender:t,damage:a}),t.takeDamage(a),e===this.player?(this.comboCount+=1,this.comboMultiplier=Math.min(5,1+Math.floor(this.comboCount/2)),this.player.score+=a*this.comboMultiplier,this.emit("combo",{count:this.comboCount,multiplier:this.comboMultiplier}),this.resetComboTimer()):(this.comboCount=0,this.comboMultiplier=1,this.emit("comboEnded"))}else e===this.player&&(this.comboCount=0,this.comboMultiplier=1,this.emit("comboBroke"))}resetComboTimer(){this.comboTimer&&this.comboTimer.remove(),this.comboTimer=this.scene.time.delayedCall(this.comboBreakDuration,()=>{this.comboCount=0,this.comboMultiplier=1,this.emit("comboEnded")})}}class d{constructor(e,t,s){this.scene=e,this.player=t,this.enemy=s,this.playerHealthBar=e.add.rectangle(200,40,300,28,3066944).setOrigin(0,.5),this.enemyHealthBar=e.add.rectangle(780,40,300,28,15158332).setOrigin(0,.5),this.scoreText=e.add.text(650,20,"Score: 0",{font:"24px Arial",color:"#fff"}).setOrigin(.5),this.comboText=e.add.text(650,70,"",{font:"32px Arial",color:"#ffeb3b"}).setOrigin(.5),this.staminaBar=e.add.rectangle(200,80,300,16,3447003).setOrigin(0,.5),this.moveListText=e.add.text(40,120,"Moves: ←/→/A/D = Move | SPACE = Punch | E = Kick | Hold B = Block",{font:"18px Arial",color:"#fff"}),this.pauseOverlay=e.add.rectangle(e.scale.width/2,e.scale.height/2,e.scale.width,e.scale.height,0,.4).setVisible(!1),this.pauseText=e.add.text(e.scale.width/2,e.scale.height/2,"PAUSED",{font:"56px Arial",color:"#fff"}).setOrigin(.5).setVisible(!1),this.fpsText=e.add.text(10,10,"",{font:"16px Arial",color:"#888"}),e.combatSystem.on("combo",e=>this.showCombo(e.count,e.multiplier)),e.combatSystem.on("comboEnded",()=>this.hideCombo()),e.combatSystem.on("comboBroke",()=>this.comboText.setText("Combo Broke!").setColor("#e74c3c")),this.criticalHealthThreshold=.25}update(){this.playerHealthBar.width=this.player.health/this.player.maxHealth*300,this.enemyHealthBar.width=this.enemy.health/this.enemy.maxHealth*300,this.player.health/this.player.maxHealth<this.criticalHealthThreshold?this.playerHealthBar.setFillStyle(16728374):this.playerHealthBar.setFillStyle(3066944),this.enemy.health/this.enemy.maxHealth<this.criticalHealthThreshold?this.enemyHealthBar.setFillStyle(16728374):this.enemyHealthBar.setFillStyle(15158332),this.staminaBar.width=this.player.stamina/this.player.maxStamina*300,this.scoreText.setText(`Score: ${this.player.score}`),this.fpsText.setText(`FPS: ${Math.floor(this.scene.game.loop.actualFps)}`)}showCombo(e,t){this.comboText.setText(`Combo x${t}! (${e} hits)`).setColor("#ffeb3b"),this.scene.tweens.add({targets:this.comboText,scale:{from:1,to:1.3},duration:180,yoyo:!0})}hideCombo(){this.comboText.setText("")}showPause(e){this.pauseOverlay.setVisible(e),this.pauseText.setVisible(e)}}class p extends(c()){constructor(e){super(),this.keyboard=e,this.cursors=e.createCursorKeys(),this.keys=e.addKeys({W:i().Input.Keyboard.KeyCodes.W,A:i().Input.Keyboard.KeyCodes.A,S:i().Input.Keyboard.KeyCodes.S,D:i().Input.Keyboard.KeyCodes.D,SPACE:i().Input.Keyboard.KeyCodes.SPACE,E:i().Input.Keyboard.KeyCodes.E,ESC:i().Input.Keyboard.KeyCodes.ESC}),this.keys.SPACE.on("down",()=>this.emit("attack","punch")),this.keys.E.on("down",()=>this.emit("attack","kick")),this.keys.ESC.on("down",()=>this.emit("pause")),e.on("keydown",e=>{switch(e.code){case"ArrowLeft":case"KeyA":this.emit("move","left");break;case"ArrowRight":case"KeyD":this.emit("move","right");break;case"ArrowUp":case"KeyW":this.emit("move","up");break;case"ArrowDown":case"KeyS":this.emit("move","down")}})}}const y="active",u="paused",k="finished";class b extends i().Scene{constructor(){super("GameScene"),this.state=y}create(){this.player=new h(this,200,500),this.enemy=new n(this,1080,500,"easy"),this.combatSystem=new m(this,this.player,this.enemy),this.uiManager=new d(this,this.player,this.enemy),this.inputHandler=new p(this.input.keyboard),this.inputHandler.on("pause",()=>this.togglePause()),this.inputHandler.on("attack",e=>this.player.handleAttack(e)),this.events.on("gameover",()=>this.endGame()),this.input.keyboard.on("keydown-ESC",()=>this.togglePause())}update(e,t){this.state!==u&&this.state!==k&&(this.player.update(e,t),this.enemy.update(e,t),this.combatSystem.update(e,t),this.uiManager.update(),(this.player.health<=0||this.enemy.health<=0)&&(this.state=k,this.events.emit("gameover")))}togglePause(){this.state=this.state===u?y:u,this.uiManager.showPause(this.state===u)}endGame(){this.scene.start("GameOverScene",{winner:this.player.health>0?"Player":"Enemy",score:this.player.score})}}class f extends i().Scene{constructor(){super("GameOverScene")}init(e){this.winner=e.winner,this.score=e.score}create(){this.add.text(this.scale.width/2,200,"Game Over!",{font:"56px Arial",color:"#fff"}).setOrigin(.5),this.add.text(this.scale.width/2,300,`Winner: ${this.winner}`,{font:"32px Arial",color:"#fff"}).setOrigin(.5),this.add.text(this.scale.width/2,380,`Score: ${this.score}`,{font:"32px Arial",color:"#fff"}).setOrigin(.5),this.add.text(this.scale.width/2,480,"Replay",{font:"32px Arial",color:"#222",backgroundColor:"#fff",padding:{x:20,y:10}}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",()=>this.scene.start("GameScene")),this.add.text(this.scale.width/2,560,"Main Menu",{font:"32px Arial",color:"#222",backgroundColor:"#fff",padding:{x:20,y:10}}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",()=>this.scene.start("MenuScene"))}}const g={type:i().AUTO,width:1280,height:720,backgroundColor:"#222",parent:"game-container",physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1}},scene:[r,b,f],scale:{mode:i().Scale.FIT,autoCenter:i().Scale.CENTER_BOTH}};new(i().Game)(g)}},s={};function a(e){var i=s[e];if(void 0!==i)return i.exports;var r=s[e]={exports:{}};return t[e].call(r.exports,r,r.exports,a),r.exports}a.m=t,e=[],a.O=(t,s,i,r)=>{if(!s){var h=1/0;for(c=0;c<e.length;c++){for(var[s,i,r]=e[c],o=!0,n=0;n<s.length;n++)(!1&r||h>=r)&&Object.keys(a.O).every(e=>a.O[e](s[n]))?s.splice(n--,1):(o=!1,r<h&&(h=r));if(o){e.splice(c--,1);var l=i();void 0!==l&&(t=l)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[s,i,r]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={792:0};a.O.j=t=>0===e[t];var t=(t,s)=>{var i,r,[h,o,n]=s,l=0;if(h.some(t=>0!==e[t])){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(n)var c=n(a)}for(t&&t(s);l<h.length;l++)r=h[l],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(c)},s=self.webpackChunkkarate_kido_game=self.webpackChunkkarate_kido_game||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var i=a.O(void 0,[442],()=>a(295));i=a.O(i)})();
//# sourceMappingURL=main.ac7a4e80358f88494ac0.js.map